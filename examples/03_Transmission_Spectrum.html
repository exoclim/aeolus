<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Working with synthetic observations &mdash; aeolus 0.4.16+20.g5b2cd28 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/nbsphinx-code-cells.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="A primer on calculating rotational and divergent wind components" href="04_Rotational_And_Divergent_Winds.html" />
    <link rel="prev" title="Model variable names" href="02_Model_Field_Names.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            aeolus
          </a>
              <div class="version">
                0.4.16+20.g5b2cd28
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="00_Constants.html">Physical constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="01_Loading_Data.html">Working with model output</a></li>
<li class="toctree-l2"><a class="reference internal" href="02_Model_Field_Names.html">Model variable names</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Working with synthetic observations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Transmission-spectrum">Transmission spectrum</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="04_Rotational_And_Divergent_Winds.html">A primer on calculating rotational and divergent wind components</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributor’s Guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">aeolus</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Examples</a></li>
      <li class="breadcrumb-item active">Working with synthetic observations</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/examples/03_Transmission_Spectrum.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Working-with-synthetic-observations">
<h1>Working with synthetic observations<a class="headerlink" href="#Working-with-synthetic-observations" title="Permalink to this heading"></a></h1>
<section id="Transmission-spectrum">
<h2>Transmission spectrum<a class="headerlink" href="#Transmission-spectrum" title="Permalink to this heading"></a></h2>
<p>An atmosphere’s transmission spectrum is the sum of absorption spectra of atoms and molecules present in the atmosphere.</p>
<p>The methodology of obtaining the information needed to calculate the synthetic transmission spectrum using the Met Office Unified Model (UM) output is reported in Lines et al. (2018):</p>
<ul class="simple">
<li><p><a class="reference external" href="https://academic.oup.com/mnras/article/481/1/194/5078378">https://academic.oup.com/mnras/article/481/1/194/5078378</a> (publisher)</p></li>
<li><p><a class="reference external" href="https://arxiv.org/abs/1808.05887">https://arxiv.org/abs/1808.05887</a> (arXiv)</p></li>
</ul>
<p>Please note that Lines et al. (2018) take into account the atmospheric conditions in the columns on the nightside of the planet limb only. The instructions on how to obtain the same information for the dayside are here:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://exoclimatology.com/wiki/index.php?title=Transmission_Spectra">http://exoclimatology.com/wiki/index.php?title=Transmission_Spectra</a> (requires login)</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">aeolus.synthobs</span></code> requires the following inputs to calculate the synthetic transmission spectrum:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">spectral_file</span></code> - SOCRATES spectral file used by the UM</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stellar_constant_at_1_au</span></code> in [W m-2]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stellar_radius</span></code> in [m]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">planet_top_of_atmosphere</span></code> in [m], which is the extent of the planetary atmosphere (usually, it is the sum of the planetary radius and the height of the model domain)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">planet_transmission_day</span></code> - UM m01s01i755 output (for hot Jupiters) from the dayside calculation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">planet_transmission_night</span></code> - UM m01s01i755 output (for hot Jupiters) from the nightside calculation</p></li>
</ul>
<p>Below is an example of such a calculation that uses a test spectral file and two test UM output files. The files are available at <a class="reference external" href="https://github.com/exoclim/aeolus_data">https://github.com/exoclim/aeolus_data</a>.</p>
<ol class="arabic simple">
<li><p>Import relevant packages</p></li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span> <span class="nn">iris</span>
<span class="kn">import</span> <span class="nn">iris.cube</span>
<span class="kn">import</span> <span class="nn">iris.quickplot</span> <span class="k">as</span> <span class="nn">qplt</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">aeolus.model</span> <span class="kn">import</span> <span class="n">um</span>
<span class="kn">from</span> <span class="nn">aeolus.synthobs</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">calc_stellar_flux</span><span class="p">,</span>
    <span class="n">calc_transmission_spectrum</span><span class="p">,</span>
    <span class="n">calc_transmission_spectrum_day_night_average</span><span class="p">,</span>
    <span class="n">read_normalized_stellar_flux</span><span class="p">,</span>
    <span class="n">read_spectral_bands</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="s2">&quot;iris&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;mathtext.default&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;regular&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris</span><span class="o">.</span><span class="n">FUTURE</span><span class="o">.</span><span class="n">datum_support</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note that the file paths should be pathlib.Path-like objects, not just plain strings!</span>
<span class="n">TEST_DIR</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;tests&quot;</span> <span class="o">/</span> <span class="s2">&quot;data&quot;</span> <span class="o">/</span> <span class="s2">&quot;test_data&quot;</span>
</pre></div>
</div>
</div>
<ol class="arabic simple" start="2">
<li><p>Provide the required inputs</p></li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spectral_file</span> <span class="o">=</span> <span class="n">TEST_DIR</span> <span class="o">/</span> <span class="s2">&quot;spectral&quot;</span> <span class="o">/</span> <span class="s2">&quot;sp_sw_500ir_bd_hatp11&quot;</span>
<span class="n">data_file</span> <span class="o">=</span> <span class="n">TEST_DIR</span> <span class="o">/</span> <span class="s2">&quot;netcdf&quot;</span> <span class="o">/</span> <span class="s2">&quot;planet_transmission_day.nc&quot;</span>
<span class="n">planet_transmission_day</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">load_cube</span><span class="p">(</span><span class="n">data_file</span><span class="p">)</span>

<span class="c1"># To keep the units of stellar and planetary parameters, store the parameters as iris cubes</span>
<span class="n">stellar_constant_at_1_au</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">cube</span><span class="o">.</span><span class="n">Cube</span><span class="p">(</span>
    <span class="mf">300.85538168664425</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;W m-2&quot;</span><span class="p">,</span> <span class="n">long_name</span><span class="o">=</span><span class="s2">&quot;stellar_constant_at_1_au&quot;</span>
<span class="p">)</span>
<span class="n">stellar_radius</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">cube</span><span class="o">.</span><span class="n">Cube</span><span class="p">(</span><span class="mf">475026500.0</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="n">long_name</span><span class="o">=</span><span class="s2">&quot;stellar_radius&quot;</span><span class="p">)</span>
<span class="n">planet_radius</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">cube</span><span class="o">.</span><span class="n">Cube</span><span class="p">(</span><span class="mf">27195379.0</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="n">long_name</span><span class="o">=</span><span class="s2">&quot;planet_radius&quot;</span><span class="p">)</span>
<span class="n">planet_domain_height</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">cube</span><span class="o">.</span><span class="n">Cube</span><span class="p">(</span><span class="mf">1.8e6</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="n">long_name</span><span class="o">=</span><span class="s2">&quot;height_domain&quot;</span><span class="p">)</span>
<span class="n">planet_top_of_atmosphere</span> <span class="o">=</span> <span class="n">planet_radius</span> <span class="o">+</span> <span class="n">planet_domain_height</span>
</pre></div>
</div>
</div>
<ol class="arabic simple" start="3">
<li><p>Check if the information about the spectral bands is read in correctly</p></li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spectral_bands</span> <span class="o">=</span> <span class="n">read_spectral_bands</span><span class="p">(</span><span class="n">spectral_file</span><span class="p">)</span>
<span class="n">spectral_bands</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>  <span class="c1"># print the first four spectral bands</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([(1, 0.001     , 0.01      ), (2, 0.0005    , 0.001     ),
       (3, 0.00033333, 0.0005    ), (4, 0.00025   , 0.00033333)],
      dtype=[(&#39;spectral_band_index&#39;, &#39;&lt;u4&#39;), (&#39;lower_wavelength_limit&#39;, &#39;&lt;f4&#39;), (&#39;upper_wavelength_limit&#39;, &#39;&lt;f4&#39;)])
</pre></div></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Check if the information about the normalized stellar flux per spectral band is read in correctly</p></li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">normalized_stellar_flux</span> <span class="o">=</span> <span class="n">read_normalized_stellar_flux</span><span class="p">(</span><span class="n">spectral_file</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">normalized_stellar_flux</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;spectral_band_index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">points</span><span class="p">,</span>
    <span class="n">normalized_stellar_flux</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Spectral band index&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Normalized stellar flux&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_03_Transmission_Spectrum_13_0.png" src="../_images/examples_03_Transmission_Spectrum_13_0.png" />
</div>
</div>
<ol class="arabic simple" start="5">
<li><p>Calculate the stellar flux per spectral band</p></li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stellar_flux</span> <span class="o">=</span> <span class="n">calc_stellar_flux</span><span class="p">(</span><span class="n">spectral_file</span><span class="p">,</span> <span class="n">stellar_constant_at_1_au</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">stellar_flux</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;spectral_band_index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">points</span><span class="p">,</span> <span class="n">stellar_flux</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Spectral band index&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Stellar flux [W $m^{-2}$]&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_03_Transmission_Spectrum_15_0.png" src="../_images/examples_03_Transmission_Spectrum_15_0.png" />
</div>
</div>
<ol class="arabic simple" start="6">
<li><p>Check if you use the correct UM output by plotting the m01s01i755 field at a single spectral band</p></li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qplt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">planet_transmission_day</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="o">...</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_03_Transmission_Spectrum_17_0.png" src="../_images/examples_03_Transmission_Spectrum_17_0.png" />
</div>
</div>
<ol class="arabic simple" start="6">
<li><p>Calculate transmission spectrum as a planet-to-star radius ratio</p></li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rp_eff_over_rs</span> <span class="o">=</span> <span class="n">calc_transmission_spectrum</span><span class="p">(</span>
    <span class="n">planet_transmission_day</span><span class="p">,</span>
    <span class="n">spectral_file</span><span class="p">,</span>
    <span class="n">stellar_constant_at_1_au</span><span class="p">,</span>
    <span class="n">stellar_radius</span><span class="p">,</span>
    <span class="n">planet_top_of_atmosphere</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">um</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<ol class="arabic simple" start="7">
<li><p>Calculate transmission spectrum averaged over the dayside and the nightside</p></li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">planet_transmission_night</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">load_cube</span><span class="p">(</span><span class="n">TEST_DIR</span> <span class="o">/</span> <span class="s2">&quot;netcdf&quot;</span> <span class="o">/</span> <span class="s2">&quot;planet_transmission_night.nc&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qplt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">planet_transmission_night</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="o">...</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_03_Transmission_Spectrum_22_0.png" src="../_images/examples_03_Transmission_Spectrum_22_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rp_eff_over_rs_night</span> <span class="o">=</span> <span class="n">calc_transmission_spectrum</span><span class="p">(</span>
    <span class="n">planet_transmission_night</span><span class="p">,</span>
    <span class="n">spectral_file</span><span class="p">,</span>
    <span class="n">stellar_constant_at_1_au</span><span class="p">,</span>
    <span class="n">stellar_radius</span><span class="p">,</span>
    <span class="n">planet_top_of_atmosphere</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">um</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rp_eff_over_rs_dn</span> <span class="o">=</span> <span class="n">calc_transmission_spectrum_day_night_average</span><span class="p">(</span>
    <span class="n">planet_transmission_day</span><span class="p">,</span>
    <span class="n">planet_transmission_night</span><span class="p">,</span>
    <span class="n">spectral_file</span><span class="p">,</span>
    <span class="n">stellar_constant_at_1_au</span><span class="p">,</span>
    <span class="n">stellar_radius</span><span class="p">,</span>
    <span class="n">planet_top_of_atmosphere</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">um</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">axins</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">inset_axes</span><span class="p">([</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">])</span>
<span class="n">axins</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">axins</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.003675</span><span class="p">,</span> <span class="mf">0.003690</span><span class="p">)</span>
<span class="k">for</span> <span class="n">_ax</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">axins</span><span class="p">):</span>
    <span class="n">_ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">rp_eff_over_rs</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;spectral_band_centres&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">points</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
        <span class="n">rp_eff_over_rs</span><span class="o">.</span><span class="n">data</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Dayside&quot;</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">_ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">rp_eff_over_rs_night</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;spectral_band_centres&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">points</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
        <span class="n">rp_eff_over_rs_night</span><span class="o">.</span><span class="n">data</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Nightside&quot;</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">_ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">rp_eff_over_rs_dn</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;spectral_band_centres&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">points</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
        <span class="n">rp_eff_over_rs_dn</span><span class="o">.</span><span class="n">data</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Average over the dayside and nightside&quot;</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Transmission spectrum&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Wavelength [$\mu$m]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;($R_p/R_s)^2$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>

<span class="n">xticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">1400</span><span class="p">,</span> <span class="mi">500</span><span class="p">),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">10001</span><span class="p">,</span> <span class="mi">500</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">xticks</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">indicate_inset_zoom</span><span class="p">(</span><span class="n">axins</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower left&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_03_Transmission_Spectrum_25_0.png" src="../_images/examples_03_Transmission_Spectrum_25_0.png" />
</div>
</div>
<ol class="arabic simple" start="8">
<li><p>Check what the band limits are</p></li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rp_eff_over_rs_dn</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;spectral_band_upper_limit&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">points</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([0.01      , 0.001     , 0.0005    , 0.00033333, 0.00025   ,
       0.0002    , 0.00016667, 0.00014286, 0.000125  , 0.00011111],
      dtype=float32)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rp_eff_over_rs_dn</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;spectral_band_lower_limit&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">points</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([1.0000000e-03, 5.0000002e-04, 3.3333333e-04, 2.5000001e-04,
       1.9999999e-04, 1.6666666e-04, 1.4285714e-04, 1.2500001e-04,
       1.1111111e-04, 9.9999997e-05], dtype=float32)
</pre></div></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="02_Model_Field_Names.html" class="btn btn-neutral float-left" title="Model variable names" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="04_Rotational_And_Divergent_Winds.html" class="btn btn-neutral float-right" title="A primer on calculating rotational and divergent wind components" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020 - 2023, aeolus contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>